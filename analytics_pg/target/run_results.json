{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2024-12-13T10:38:48.709104Z", "invocation_id": "ffacdb52-150d-495e-b8e8-3eeaf86969cb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.178634Z", "completed_at": "2024-12-13T10:38:48.192516Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.193876Z", "completed_at": "2024-12-13T10:38:48.193894Z"}], "thread_id": "Thread-1", "execution_time": 0.017949819564819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.stg_branches", "compiled": true, "compiled_code": "with source as (\n    select * from \"postgres\".\"public\".\"branches\"\n),\n\nstaged as (\n    select\n        id as branch_id,\n        name,\n        city,\n        state,\n        country,\n        business_id,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as branch_sk,\n        created_at\n    from source\n)\n\nselect * from staged", "relation_name": "\"postgres\".\"public_staging\".\"stg_branches\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.198191Z", "completed_at": "2024-12-13T10:38:48.205327Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.206728Z", "completed_at": "2024-12-13T10:38:48.206742Z"}], "thread_id": "Thread-1", "execution_time": 0.011488199234008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select * from \"postgres\".\"public\".\"customers\"\n),\n\nstaged as (\n    select\n        id as customer_id,\n        business_id,\n        name as customer_name,\n        created_at,\n        last_visit,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_sk\n    from source\n)\n\nselect * from staged", "relation_name": "\"postgres\".\"public_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.211064Z", "completed_at": "2024-12-13T10:38:48.218765Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.220291Z", "completed_at": "2024-12-13T10:38:48.220308Z"}], "thread_id": "Thread-1", "execution_time": 0.012147665023803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.stg_order_items", "compiled": true, "compiled_code": "with source as (\n    select * from \"postgres\".\"public\".\"orderitems\"\n),\n\nstaged as (\n    select\n        id as order_item_id,\n        order_id,\n        product_id,\n        quantity,\n        item_total,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_item_sk\n    from source\n)\n\nselect * from staged", "relation_name": "\"postgres\".\"public_staging\".\"stg_order_items\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.225287Z", "completed_at": "2024-12-13T10:38:48.233854Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.235173Z", "completed_at": "2024-12-13T10:38:48.235188Z"}], "thread_id": "Thread-1", "execution_time": 0.012588739395141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.stg_orders", "compiled": true, "compiled_code": "with source as (\n    select * from \"postgres\".\"public\".\"orders\"\n),\n\nstaged as (\n    select\n        id as order_id,\n        branch_id,\n        customer_id,\n        order_total,\n        status,\n        order_date,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_sk\n    from source\n    where status = 'completed' -- Only include completed orders\n)\n\nselect * from staged", "relation_name": "\"postgres\".\"public_staging\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.239626Z", "completed_at": "2024-12-13T10:38:48.247051Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.248396Z", "completed_at": "2024-12-13T10:38:48.248411Z"}], "thread_id": "Thread-1", "execution_time": 0.011656999588012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.stg_products", "compiled": true, "compiled_code": "with source as (\n    select * from \"postgres\".\"public\".\"products\"\n),\n\nstaged as (\n    select\n        id as product_id,\n        branch_id,\n        name as product_name,\n        price,\n        md5(cast(coalesce(cast(id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_sk\n    from source\n)\n\nselect * from staged", "relation_name": "\"postgres\".\"public_staging\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.253336Z", "completed_at": "2024-12-13T10:38:48.270431Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.271780Z", "completed_at": "2024-12-13T10:38:48.271796Z"}], "thread_id": "Thread-1", "execution_time": 0.02153611183166504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_not_null_raw_branches_id.2f6aee2abd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"branches\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.276632Z", "completed_at": "2024-12-13T10:38:48.286632Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.288280Z", "completed_at": "2024-12-13T10:38:48.288297Z"}], "thread_id": "Thread-1", "execution_time": 0.015126466751098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_not_null_raw_customers_id.bb348d55ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"customers\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.294768Z", "completed_at": "2024-12-13T10:38:48.303874Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.305228Z", "completed_at": "2024-12-13T10:38:48.305242Z"}], "thread_id": "Thread-1", "execution_time": 0.014298200607299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_not_null_raw_orderitems_id.afda35acca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"orderitems\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.312301Z", "completed_at": "2024-12-13T10:38:48.323199Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.325098Z", "completed_at": "2024-12-13T10:38:48.325113Z"}], "thread_id": "Thread-1", "execution_time": 0.01685643196105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_not_null_raw_orders_id.f232a64478", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"orders\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.331144Z", "completed_at": "2024-12-13T10:38:48.339803Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.342487Z", "completed_at": "2024-12-13T10:38:48.342503Z"}], "thread_id": "Thread-1", "execution_time": 0.015884876251220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_not_null_raw_products_id.ffffd25704", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"postgres\".\"public\".\"products\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.350563Z", "completed_at": "2024-12-13T10:38:48.364791Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.366372Z", "completed_at": "2024-12-13T10:38:48.366387Z"}], "thread_id": "Thread-1", "execution_time": 0.020565032958984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_unique_raw_branches_id.581c7dd97d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"branches\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.371425Z", "completed_at": "2024-12-13T10:38:48.379099Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.380543Z", "completed_at": "2024-12-13T10:38:48.380557Z"}], "thread_id": "Thread-1", "execution_time": 0.011771202087402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_unique_raw_customers_id.9027d6b367", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"customers\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.384888Z", "completed_at": "2024-12-13T10:38:48.392068Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.393338Z", "completed_at": "2024-12-13T10:38:48.393351Z"}], "thread_id": "Thread-1", "execution_time": 0.011061906814575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_unique_raw_orderitems_id.ac5bf66f2f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"orderitems\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.397923Z", "completed_at": "2024-12-13T10:38:48.405304Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.406832Z", "completed_at": "2024-12-13T10:38:48.406845Z"}], "thread_id": "Thread-1", "execution_time": 0.011768341064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_unique_raw_orders_id.56401af608", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"orders\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.411582Z", "completed_at": "2024-12-13T10:38:48.418736Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.420158Z", "completed_at": "2024-12-13T10:38:48.420172Z"}], "thread_id": "Thread-1", "execution_time": 0.011562824249267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.source_unique_raw_products_id.c236eee754", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"products\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.424780Z", "completed_at": "2024-12-13T10:38:48.429858Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.431254Z", "completed_at": "2024-12-13T10:38:48.431345Z"}], "thread_id": "Thread-1", "execution_time": 0.009434938430786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_product_bundles", "compiled": true, "compiled_code": "with order_items as (\n    select * from \"postgres\".\"public_staging\".\"stg_order_items\"\n),\n\nproduct_pairs as (\n    select\n        a.order_id,\n        a.product_id as product_1,\n        b.product_id as product_2,\n        count(*) as times_bought_together\n    from order_items a\n    join order_items b \n        on a.order_id = b.order_id \n        and a.product_id < b.product_id\n    group by 1, 2, 3\n),\n\nbundle_metrics as (\n    select\n        product_1,\n        product_2,\n        sum(times_bought_together) as total_bundled,\n        count(distinct order_id) as bundle_orders\n    from product_pairs\n    group by 1, 2\n)\n\nselect * from bundle_metrics", "relation_name": "\"postgres\".\"public_marts\".\"fct_product_bundles\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.436117Z", "completed_at": "2024-12-13T10:38:48.443558Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.444763Z", "completed_at": "2024-12-13T10:38:48.444777Z"}], "thread_id": "Thread-1", "execution_time": 0.011636972427368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_orders", "compiled": true, "compiled_code": "with orders as (\n    select * from \"postgres\".\"public_staging\".\"stg_orders\"\n),\n\norder_items as (\n    select * from \"postgres\".\"public_staging\".\"stg_order_items\"\n),\n\ncustomers as (\n    select * from \"postgres\".\"public_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        o.order_sk,\n        o.order_id,\n        o.branch_id,\n        o.customer_id,\n        c.name as customer_name,\n        o.order_date,\n        o.order_total,\n        count(distinct oi.order_item_id) as num_items,\n        sum(oi.quantity) as total_quantity,\n        o.status\n    from orders o\n    left join order_items oi on o.order_id = oi.order_id\n    left join customers c on o.customer_id = c.id\n    group by 1,2,3,4,5,6,7,10\n)\n\nselect * from final", "relation_name": "\"postgres\".\"public_marts\".\"fct_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.449571Z", "completed_at": "2024-12-13T10:38:48.454434Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.455746Z", "completed_at": "2024-12-13T10:38:48.455759Z"}], "thread_id": "Thread-1", "execution_time": 0.008973360061645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_real_time_metrics", "compiled": true, "compiled_code": "with recent_orders as (\n    select * \n    from \"postgres\".\"public_staging\".\"stg_orders\"\n    where order_date >= now() - interval '24 hours'\n),\n\nhourly_metrics as (\n    select\n        branch_id,\n        date_trunc('hour', order_date) as hour,\n        count(*) as orders_count,\n        sum(order_total) as revenue,\n        count(distinct customer_id) as unique_customers\n    from recent_orders\n    group by 1, 2\n)\n\nselect * from hourly_metrics", "relation_name": "\"postgres\".\"public_marts\".\"fct_real_time_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.460379Z", "completed_at": "2024-12-13T10:38:48.466447Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.467959Z", "completed_at": "2024-12-13T10:38:48.467971Z"}], "thread_id": "Thread-1", "execution_time": 0.010787487030029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_sales_trends", "compiled": true, "compiled_code": "with daily_sales as (\n    select\n        date_trunc('hour', order_date) as time_bucket,\n        sum(order_total) as sales_amount,\n        count(distinct id) as num_orders\n    from \"postgres\".\"public_staging\".\"stg_orders\"\n    where order_date >= current_date - interval '1 day'\n    group by 1\n),\n\nweekly_sales as (\n    select\n        date_trunc('day', order_date) as time_bucket,\n        sum(order_total) as sales_amount,\n        count(distinct id) as num_orders\n    from \"postgres\".\"public_staging\".\"stg_orders\"\n    where order_date >= current_date - interval '7 days'\n    group by 1\n),\n\nmonthly_sales as (\n    select\n        date_trunc('day', order_date) as time_bucket,\n        sum(order_total) as sales_amount,\n        count(distinct id) as num_orders\n    from \"postgres\".\"public_staging\".\"stg_orders\"\n    where order_date >= current_date - interval '30 days'\n    group by 1\n),\n\nyearly_sales as (\n    select\n        date_trunc('month', order_date) as time_bucket,\n        sum(order_total) as sales_amount,\n        count(distinct id) as num_orders\n    from \"postgres\".\"public_staging\".\"stg_orders\"\n    where order_date >= current_date - interval '1 year'\n    group by 1\n),\n\nfinal as (\n    select \n        'daily' as time_range,\n        time_bucket,\n        sales_amount,\n        num_orders\n    from daily_sales\n    \n    union all\n    \n    select \n        'weekly' as time_range,\n        time_bucket,\n        sales_amount,\n        num_orders\n    from weekly_sales\n    \n    union all\n    \n    select \n        'monthly' as time_range,\n        time_bucket,\n        sales_amount,\n        num_orders\n    from monthly_sales\n    \n    union all\n    \n    select \n        'yearly' as time_range,\n        time_bucket,\n        sales_amount,\n        num_orders\n    from yearly_sales\n)\n\nselect * from final", "relation_name": "\"postgres\".\"public_marts\".\"fct_sales_trends\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.472650Z", "completed_at": "2024-12-13T10:38:48.477440Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.479262Z", "completed_at": "2024-12-13T10:38:48.479276Z"}], "thread_id": "Thread-1", "execution_time": 0.009456872940063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.int_customer_lifetime_value", "compiled": true, "compiled_code": "with orders as (\n    select * from \"postgres\".\"public_staging\".\"stg_orders\"\n),\n\ncustomer_metrics as (\n    select\n        customer_id,\n        count(distinct order_id) as total_orders,\n        sum(order_total) as total_spent,\n        avg(order_total) as avg_order_value,\n        min(order_date) as first_purchase,\n        max(order_date) as last_purchase,\n        count(distinct date_trunc('month', order_date)) as active_months\n    from orders\n    group by 1\n),\n\nfinal as (\n    select\n        *,\n        total_spent / nullif(active_months, 0) as monthly_value,\n        date_part('day', now() - last_purchase) as days_since_last_purchase\n    from customer_metrics\n)\n\nselect * from final", "relation_name": "\"postgres\".\"public\".\"int_customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.483960Z", "completed_at": "2024-12-13T10:38:48.488580Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.489792Z", "completed_at": "2024-12-13T10:38:48.489803Z"}], "thread_id": "Thread-1", "execution_time": 0.008534908294677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.int_daily_sales", "compiled": true, "compiled_code": "with orders as (\n    select * from \"postgres\".\"public_staging\".\"stg_orders\"\n),\n\ndaily_metrics as (\n    select\n        branch_id,\n        date_trunc('day', order_date) as date,\n        count(distinct order_id) as num_orders,\n        count(distinct customer_id) as num_customers,\n        sum(order_total) as total_sales,\n        avg(order_total) as avg_order_value\n    from orders\n    group by 1, 2\n)\n\nselect * from daily_metrics", "relation_name": "\"postgres\".\"public\".\"int_daily_sales\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.494648Z", "completed_at": "2024-12-13T10:38:48.500893Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.502279Z", "completed_at": "2024-12-13T10:38:48.502292Z"}], "thread_id": "Thread-1", "execution_time": 0.010806560516357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_recent_transactions", "compiled": true, "compiled_code": "with orders as (\n    select * from \"postgres\".\"public_staging\".\"stg_orders\"\n),\n\norder_items as (\n    select * from \"postgres\".\"public_staging\".\"stg_order_items\"\n),\n\nproducts as (\n    select * from \"postgres\".\"public_staging\".\"stg_products\"\n),\n\ncustomers as (\n    select * from \"postgres\".\"public_staging\".\"stg_customers\"\n),\n\norder_details as (\n    select\n        o.order_id,\n        o.order_date,\n        o.order_total,\n        c.id as customer_id,\n        c.name as customer_name,\n        json_agg(\n            json_build_object(\n                'name', p.name,\n                'quantity', oi.quantity,\n                'price', p.price\n            )\n        ) as items\n    from orders o\n    join customers c on o.customer_id = c.id\n    join order_items oi on o.order_id = oi.order_id\n    join products p on oi.product_id = p.id\n    group by 1, 2, 3, 4, 5\n),\n\nfinal as (\n    select *\n    from order_details\n    where order_date >= current_timestamp - interval '24 hours'\n    order by order_date desc\n    limit 50\n)\n\nselect * from final", "relation_name": "\"postgres\".\"public_marts\".\"fct_recent_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.507436Z", "completed_at": "2024-12-13T10:38:48.513718Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.515231Z", "completed_at": "2024-12-13T10:38:48.515248Z"}], "thread_id": "Thread-1", "execution_time": 0.01114511489868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.int_product_performance", "compiled": true, "compiled_code": "with order_items as (\n    select * from \"postgres\".\"public_staging\".\"stg_order_items\"\n),\n\nproducts as (\n    select * from \"postgres\".\"public_staging\".\"stg_products\"\n),\n\nproduct_metrics as (\n    select\n        p.branch_id,\n        oi.product_id,\n        p.product_name,\n        p.price,\n        sum(oi.quantity) as total_quantity_sold,\n        sum(oi.item_total) as total_revenue,\n        count(distinct oi.order_id) as number_of_orders\n    from order_items oi\n    join products p on oi.product_id = p.product_id\n    group by 1, 2, 3, 4\n)\n\nselect * from product_metrics", "relation_name": "\"postgres\".\"public\".\"int_product_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.520500Z", "completed_at": "2024-12-13T10:38:48.626020Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.627578Z", "completed_at": "2024-12-13T10:38:48.627593Z"}], "thread_id": "Thread-1", "execution_time": 0.1102297306060791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.not_null_fct_orders_order_sk.17f7cf1440", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_sk\nfrom \"postgres\".\"public_marts\".\"fct_orders\"\nwhere order_sk is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.631826Z", "completed_at": "2024-12-13T10:38:48.638701Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.640352Z", "completed_at": "2024-12-13T10:38:48.640368Z"}], "thread_id": "Thread-1", "execution_time": 0.011909246444702148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.trendsphere_analytics.unique_fct_orders_order_sk.a7b350fdc1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_sk as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public_marts\".\"fct_orders\"\nwhere order_sk is not null\ngroup by order_sk\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.645634Z", "completed_at": "2024-12-13T10:38:48.650659Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.652012Z", "completed_at": "2024-12-13T10:38:48.652024Z"}], "thread_id": "Thread-1", "execution_time": 0.009199142456054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.dim_customer_segments", "compiled": true, "compiled_code": "with customer_value as (\n    select * from \"postgres\".\"public\".\"int_customer_lifetime_value\"\n),\n\nsegments as (\n    select\n        customer_id,\n        case \n            when total_spent >= percentile_cont(0.9) within group (order by total_spent)\n                then 'VIP'\n            when total_spent >= percentile_cont(0.7) within group (order by total_spent)\n                then 'Regular'\n            when days_since_last_purchase <= 30\n                then 'Active'\n            when days_since_last_purchase <= 90\n                then 'At Risk'\n            else 'Churned'\n        end as segment,\n        total_spent,\n        total_orders,\n        monthly_value,\n        days_since_last_purchase\n    from customer_value\n)\n\nselect * from segments", "relation_name": "\"postgres\".\"public_marts\".\"dim_customer_segments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.656172Z", "completed_at": "2024-12-13T10:38:48.661327Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.662519Z", "completed_at": "2024-12-13T10:38:48.662531Z"}], "thread_id": "Thread-1", "execution_time": 0.008949995040893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_dashboard_metrics", "compiled": true, "compiled_code": "with daily_metrics as (\n    select * from \"postgres\".\"public\".\"int_daily_sales\"\n),\n\nprev_day_metrics as (\n    select\n        branch_id,\n        date,\n        total_sales,\n        num_customers,\n        lag(total_sales) over (partition by branch_id order by date) as prev_day_sales,\n        lag(num_customers) over (partition by branch_id order by date) as prev_day_customers\n    from daily_metrics\n),\n\nfinal as (\n    select\n        current_date as metric_date,\n        coalesce(sum(dm.total_sales), 0) as total_sales,\n        coalesce(sum(dm.num_customers), 0) as total_customers,\n        coalesce(round(\n            ((sum(dm.total_sales) - sum(pdm.prev_day_sales)) / nullif(sum(pdm.prev_day_sales), 0) * 100)::numeric, \n            2\n        ), 0) as sales_growth_pct,\n        coalesce(round(\n            ((sum(dm.num_customers) - sum(pdm.prev_day_customers)) / nullif(sum(pdm.prev_day_customers), 0) * 100)::numeric,\n            2\n        ), 0) as customer_growth_pct\n    from daily_metrics dm\n    left join prev_day_metrics pdm \n        on dm.branch_id = pdm.branch_id \n        and dm.date = pdm.date\n    where dm.date >= current_date - interval '1 day'\n)\n\nselect * from final", "relation_name": "\"postgres\".\"public_marts\".\"fct_dashboard_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.667006Z", "completed_at": "2024-12-13T10:38:48.671813Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.672985Z", "completed_at": "2024-12-13T10:38:48.672997Z"}], "thread_id": "Thread-1", "execution_time": 0.009439468383789062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.int_branch_performance", "compiled": true, "compiled_code": "with daily_sales as (\n    select * from \"postgres\".\"public\".\"int_daily_sales\"\n),\n\nbranch_metrics as (\n    select\n        branch_id,\n        date_trunc('month', date) as month,\n        sum(total_sales) as monthly_sales,\n        sum(num_orders) as monthly_orders,\n        sum(num_customers) as monthly_customers,\n        avg(avg_order_value) as avg_order_value,\n        sum(total_sales) / sum(num_customers) as revenue_per_customer\n    from daily_sales\n    group by 1, 2\n)\n\nselect * from branch_metrics", "relation_name": "\"postgres\".\"public\".\"int_branch_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.678602Z", "completed_at": "2024-12-13T10:38:48.687137Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.688902Z", "completed_at": "2024-12-13T10:38:48.688919Z"}], "thread_id": "Thread-1", "execution_time": 0.013877391815185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.sales_by_branch", "compiled": true, "compiled_code": "with daily_sales as (\n    select * from \"postgres\".\"public\".\"int_daily_sales\"\n),\n\nbranches as (\n    select * from \"postgres\".\"public_staging\".\"stg_branches\"\n),\n\nfinal as (\n    select\n        b.name as branch_name,\n        b.city,\n        b.state,\n        b.country,\n        ds.date,\n        ds.num_orders,\n        ds.num_customers,\n        ds.total_sales,\n        ds.avg_order_value,\n        lag(ds.total_sales) over (partition by b.branch_id order by ds.date) as prev_day_sales,\n        (ds.total_sales - lag(ds.total_sales) over (partition by b.branch_id order by ds.date)) / \n            nullif(lag(ds.total_sales) over (partition by b.branch_id order by ds.date), 0) * 100 as sales_growth_pct\n    from daily_sales ds\n    join branches b on ds.branch_id = b.branch_id\n)\n\nselect * from final", "relation_name": "\"postgres\".\"public_marts\".\"sales_by_branch\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-13T10:38:48.695586Z", "completed_at": "2024-12-13T10:38:48.703363Z"}, {"name": "execute", "started_at": "2024-12-13T10:38:48.705032Z", "completed_at": "2024-12-13T10:38:48.705046Z"}], "thread_id": "Thread-1", "execution_time": 0.012972593307495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.trendsphere_analytics.fct_product_recommendations", "compiled": true, "compiled_code": "with product_performance as (\n    select * from \"postgres\".\"public\".\"int_product_performance\"\n),\n\nproduct_bundles as (\n    select * from \"postgres\".\"public_marts\".\"fct_product_bundles\"\n),\n\nrecommendations as (\n    select\n        pp.branch_id,\n        pp.product_id,\n        pp.product_name,\n        pp.total_revenue,\n        pp.total_quantity_sold,\n        array_agg(pb.product_2 order by pb.total_bundled desc) \n            filter (where pb.product_2 is not null)\n            as recommended_pairs\n    from product_performance pp\n    left join product_bundles pb on pp.product_id = pb.product_1\n    group by 1, 2, 3, 4, 5\n)\n\nselect * from recommendations", "relation_name": "\"postgres\".\"public_marts\".\"fct_product_recommendations\""}], "elapsed_time": 4.5490498542785645, "args": {"empty_catalog": false, "print": true, "quiet": false, "profiles_dir": "/home/ec2-user/Anas_TrendSphere/analytics_pg", "log_level": "info", "exclude": [], "defer": false, "log_file_max_bytes": 10485760, "require_explicit_package_overrides_for_builtin_materializations": false, "favor_state": false, "project_dir": "/home/ec2-user/Anas_TrendSphere/analytics_pg", "introspect": true, "strict_mode": false, "use_colors": true, "printer_width": 80, "log_format": "default", "compile": true, "static": false, "which": "generate", "populate_cache": true, "static_parser": true, "version_check": true, "log_format_file": "debug", "select": [], "use_colors_file": true, "enable_legacy_logger": false, "macro_debugging": false, "partial_parse_file_diff": true, "write_json": true, "invocation_command": "dbt docs generate", "indirect_selection": "eager", "show_resource_report": false, "log_path": "/home/ec2-user/Anas_TrendSphere/analytics_pg/logs", "partial_parse": true, "vars": {}, "log_level_file": "debug", "cache_selected_only": false, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}}}